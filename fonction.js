var historique=[];let depcode;const generatePdf=()=>{const e=document.querySelector("#communeCard article:nth-child(1) p").textContent,t=document.querySelector("#communeCard article:nth-child(2) p").textContent,n=document.querySelector("#departementCard article:nth-child(2) p").textContent,o=document.querySelector("#regionCard article:nth-child(2) p").textContent,m=document.querySelector("#communeCard article:nth-child(6) p").textContent,d=document.querySelector("#communeCard article:nth-child(5) p").textContent,c=document.querySelector("#communeCard article:nth-child(3) p").textContent,r=document.querySelector("#communeCard article:nth-child(4) p").textContent;genPDF(e,t,n,o,m,d,c,r)},addValueToElement=(e,t)=>{for(let n=1;n<=t.length;n++)document.querySelector(`#${e+"Card"} article:nth-child(${n}) p`).textContent=t[n-1]},getRegionsData=e=>{regionJson.every(t=>(t.numRegion===parseInt(e)&&(addValueToElement("region",[t.Nom,Math.round(t.SCORE_GLOBAL_REGION),Math.round(t.ACCES_A_INFORMATION),Math.round(t.ACCES_AUX_INTERFACES_NUMERIQUES),Math.round(t.COMPETENCES_NUMERIQUES_SCOLAIRES),Math.round(t.COMPETENCES_ADMINISTATIVES)]),document.getElementById("regionCard").style.display="block"),t.numRegion!==parseInt(e)))},getDepartementData=e=>{departementsJson.every(t=>(t.numero===parseInt(e)&&(addValueToElement("departement",[t.Nom,Math.round(t.Moy_Dep),Math.round(t.ACCES_A_INFORMATION),Math.round(t.ACCES_AUX_INTERFACES_NUMERIQUES),Math.round(t.COMPETENCES_NUMERIQUES_SCOLAIRES),Math.round(t.COMPETENCES_ADMINISTATIVES)]),document.getElementById("departementCard").style.display="block"),t.numero!==parseInt(e)))},getCommuneData=e=>{communeJson.every(t=>t.Code_Iris!==parseInt(e)||(addValueToElement("commune",[t.commune+" ( "+t.Libelle_Iris+" ) ",Math.round(t.SCORE_GLOBAL_commune),Math.round(t.INFORMATION),Math.round(t.INTERFACES),Math.round(t.NUMÉRIQUES),Math.round(t.ADMINISTATIVES)]),document.getElementById("communeCard").style.display="block",document.getElementById("descriptionIndiceFragilite").style.display="block",document.getElementById("btnPdf").style.display="flex",t.SCORE_GLOBAL_commune<=70?(document.getElementById("descriptionIndiceFragilite").innerHTML="La commune "+t.commune+" a un indice de fragilité faible et se trouve en partie en exclusion numérique ("+t.SCORE_GLOBAL_commune+").",t.Code_Iris!==parseInt(e)):t.SCORE_GLOBAL_commune>70&&t.SCORE_GLOBAL_commune<=100?(document.getElementById("descriptionIndiceFragilite").innerHTML="La commune "+t.commune+" a un indice de fragilité correct et n'est pas en situation d'exclusion numérique ("+t.SCORE_GLOBAL_commune+").",t.Code_Iris!==parseInt(e)):(document.getElementById("descriptionIndiceFragilite").innerHTML="La commune "+t.commune+" a un très bon indice de fragilité numérique ("+t.SCORE_GLOBAL_commune+").",t.Code_Iris!==parseInt(e))))},getDepartments=()=>{depcode=document.getElementById("departements").options[document.getElementById("departements").selectedIndex].value,document.getElementById("departementCard").style.display="block",communeJson.forEach(e=>{if(e.numDepartement===parseInt(depcode)){const t=document.createElement("option");t.value=e.Code_Iris,t.textContent=e.commune+" ( "+e.Libelle_Iris+")",document.getElementById("communes").appendChild(t)}}),getDepartementData(depcode)},getCommunes=()=>{const e=document.getElementById("communes").options[document.getElementById("communes").selectedIndex].value;document.getElementById("communeCard").style.display="block",getCommuneData(e)},getRegions=()=>{const e=document.getElementById("regions").options[document.getElementById("regions").selectedIndex].value;document.getElementById("regionCard").style.display="block",departementsJson.forEach(t=>{if(t.NumeroRegion===parseInt(e)){const e=document.createElement("option");e.value=t.numero,e.textContent=t.Nom,document.getElementById("departements").appendChild(e)}}),getRegionsData(e)},getCommune=()=>{let e,t;const n=document.getElementById("searchCommune").options[document.getElementById("searchCommune").selectedIndex].value;document.getElementById("communeCard").style.display="block",communeJson.forEach(o=>{o.Code_Iris===parseInt(n)&&(e=o.numRegion,t=o.numDepartement)}),getCommuneData(n),getDepartementData(t),getRegionsData(e)},searchByPostalCode=()=>{const e=document.getElementById("postalCode").value,t=document.getElementById("searchCommune");postalCodeJson.every(n=>{if(n.Code_postal===e){const e=parseInt(n.Code_commune_INSEE);communeJson.forEach(n=>{if(n.Code_commune===e){const e=document.createElement("option");e.value=n.Code_Iris,e.textContent=n.commune+" ( "+n.Libelle_Iris+")",t.appendChild(e)}})}return n.Code_postal!==e})};